# Tachi API Production Environment Configuration
# CRITICAL: Generate secure values for production deployment

# Server Configuration
PORT=3001
NODE_ENV=production
API_BASE_URL=https://api.tachi.network
ENABLE_TRUST_PROXY=true

# Frontend URLs
FRONTEND_URL=https://tachi.network
DASHBOARD_URL=https://tachi.network/dashboard

# Database Configuration (Supabase)
# REQUIRED: Get these from: https://supabase.com/dashboard -> Settings -> API
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_ANON_KEY=your_supabase_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here
DATABASE_SSL=true

# JWT Configuration - CRITICAL SECURITY
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=CHANGE_ME_GENERATE_SECURE_64_BYTE_SECRET_FOR_PRODUCTION
JWT_REFRESH_SECRET=CHANGE_ME_GENERATE_DIFFERENT_64_BYTE_SECRET_FOR_REFRESH_TOKENS
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=tachi-api
JWT_AUDIENCE=tachi-users

# Rate Limiting Configuration
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
AUTH_RATE_LIMIT_MAX=5
LOGIN_RATE_LIMIT_MAX=3
ENABLE_PROGRESSIVE_RATE_LIMITING=true

# Redis Configuration (REQUIRED for production)
REDIS_URL=redis://your-redis-host:6379
REDIS_PASSWORD=your_redis_password
REDIS_TLS=true

# Stripe Payment Processing
# REQUIRED: Get these from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_live_your_production_stripe_secret_key
STRIPE_PUBLISHABLE_KEY=pk_live_your_production_stripe_publishable_key
STRIPE_WEBHOOK_SECRET=whsec_your_production_webhook_endpoint_secret

# Blockchain Configuration
# Web3 provider for mainnet
WEB3_PROVIDER_URL=https://mainnet.infura.io/v3/your_infura_project_id
# OR use Alchemy: https://eth-mainnet.alchemyapi.io/v2/your_alchemy_key
CHAIN_ID=1
CONTRACT_ADDRESS_PAYMENT_PROCESSOR=0x_your_deployed_contract_address
CONTRACT_ADDRESS_CRAWL_NFT=0x_your_deployed_contract_address

# Email Configuration (REQUIRED for notifications)
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=your_sendgrid_api_key
FROM_EMAIL=noreply@tachi.network
SUPPORT_EMAIL=support@tachi.network

# Security Configuration
BCRYPT_ROUNDS=12
ENABLE_HTTPS_ONLY=true
SECURE_COOKIES=true
HELMET_ENABLED=true
CORS_ORIGINS=https://tachi.network,https://app.tachi.network

# Session Security
SESSION_SECRET=CHANGE_ME_GENERATE_SECURE_SESSION_SECRET
SESSION_MAX_AGE=86400000
SESSION_SECURE=true
SESSION_SAME_SITE=strict

# Logging & Monitoring
LOG_LEVEL=info
LOG_FILE=/var/log/tachi/api.log
ENABLE_REQUEST_LOGGING=true
ENABLE_ERROR_TRACKING=true

# Error Tracking (Sentry)
SENTRY_DSN=https://your_sentry_dsn@sentry.io/project_id
SENTRY_ENVIRONMENT=production
SENTRY_SAMPLE_RATE=0.1

# Performance Monitoring
ENABLE_PERFORMANCE_MONITORING=true
NEWRELIC_LICENSE_KEY=your_newrelic_license_key
DATADOG_API_KEY=your_datadog_api_key

# Content Security
MAX_CONTENT_SIZE_MB=10
ALLOWED_DOMAINS=tachi.network,*.tachi.network
BLOCK_SUSPICIOUS_DOMAINS=true

# File Upload Security
MAX_FILE_SIZE_MB=50
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf
ENABLE_VIRUS_SCANNING=true

# API Security
API_KEY_PREFIX=tachi_
API_KEY_LENGTH=32
ENABLE_API_KEY_ROTATION=true
API_KEY_MAX_AGE_DAYS=90

# Backup & Recovery
ENABLE_AUTOMATED_BACKUPS=true
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION_KEY=your_backup_encryption_key

# Compliance & Legal
ENABLE_AUDIT_LOGGING=true
DATA_RETENTION_DAYS=2555
GDPR_COMPLIANCE_MODE=true
ENABLE_USER_DATA_EXPORT=true

# Feature Flags
ENABLE_NEW_USER_REGISTRATION=true
ENABLE_ENTERPRISE_FEATURES=true
ENABLE_BETA_FEATURES=false
MAINTENANCE_MODE=false

# External Services
CLOUDFLARE_API_TOKEN=your_cloudflare_api_token
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=us-east-1
S3_BUCKET_NAME=tachi-production-storage

# Analytics
GOOGLE_ANALYTICS_ID=GA_MEASUREMENT_ID
MIXPANEL_TOKEN=your_mixpanel_token
ENABLE_USAGE_ANALYTICS=true

# Health Checks
HEALTH_CHECK_INTERVAL=30000
ENABLE_DEEP_HEALTH_CHECKS=true
HEALTH_CHECK_TIMEOUT=5000

# Development Overrides (set to false in production)
ENABLE_SWAGGER_DOCS=false
ENABLE_DEBUG_ENDPOINTS=false
ALLOW_CORS_ALL_ORIGINS=false
DISABLE_AUTH_FOR_TESTING=false

# Memory & Performance
NODE_OPTIONS=--max-old-space-size=4096
UV_THREADPOOL_SIZE=128
WORKER_PROCESSES=4

# SSL/TLS Configuration
SSL_CERT_PATH=/etc/ssl/certs/tachi.crt
SSL_KEY_PATH=/etc/ssl/private/tachi.key
TLS_MIN_VERSION=TLSv1.2

# Database Connection Pool
DB_POOL_MIN=2
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_ACQUIRE_TIMEOUT=30000

# Caching
CACHE_TTL_DEFAULT=300
CACHE_TTL_USER_DATA=900
CACHE_TTL_API_RESPONSES=60
ENABLE_RESPONSE_COMPRESSION=true

# Webhooks
WEBHOOK_SECRET=your_webhook_secret
WEBHOOK_TIMEOUT=10000
WEBHOOK_MAX_RETRIES=3